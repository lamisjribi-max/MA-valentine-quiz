<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Make OG Banner</title>

  <style>
    body{font-family:system-ui,Arial,sans-serif;margin:24px;background:#12060a;color:#f2efdc}
    .row{display:flex;gap:14px;flex-wrap:wrap;align-items:center}
    canvas{border:2px solid #000;border-radius:14px;image-rendering:pixelated;max-width:100%}
    button{padding:10px 14px;border-radius:10px;border:2px solid #000;background:#BE132D;color:#F2EFDC;cursor:pointer}
    input{padding:10px 12px;border-radius:10px;border:2px solid #000;background:#1a070d;color:#F2EFDC;min-width:380px}
    label{display:block;margin:10px 0 6px;opacity:.9}
    .hint{opacity:.75;font-size:14px;margin-top:10px;max-width:440px}
    .status{margin-top:10px;font-size:13px;opacity:.85}
    .status b{opacity:1}
  </style>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>

<body>
  <h1>OG Banner Generator (1200×630)</h1>

  <div class="row">
    <div>
      <label>Title</label>
      <input id="title" value="VALENTINE QUIZ" />
      <label>Subtitle</label>
      <input id="subtitle" value="a tiny valentine quiz for my pookie" />

      <div class="row" style="margin-top:14px">
        <button id="render">Render</button>
        <button id="download">Download og.png</button>
      </div>

      <div class="hint">Wait until it says the font is ready for true pixel text.</div>
      <div class="status" id="status">Font: <b>loading…</b></div>
    </div>

    <canvas id="c" width="1200" height="630"></canvas>
  </div>

<script>
const C = document.getElementById("c");
const ctx = C.getContext("2d");
ctx.imageSmoothingEnabled = false;

const statusEl = document.getElementById("status");

const heartColors = ["#B61B28", "#8E151F", "#D05D65", "#F70814"];

const bg = {
  top: "#2b050c",
  mid: "#1a070d",
  bot: "#12060a",
  panel: "rgba(26,7,13,0.88)",
  ink: "#000000",
  paper: "#F2EFDC",
  stone: "#D4C4A7",
};

let fontReady = false;

// Centered panel 
const panel = { x: 140, y: 205, w: 920, h: 220 }; 

async function ensureFont(){
  try{
    await document.fonts.ready;
    await document.fonts.load("54px 'Press Start 2P'");
    await document.fonts.load("20px 'Press Start 2P'");
    fontReady = true;
    statusEl.innerHTML = "Font: <b>Press Start 2P ready</b>";
  }catch{
    statusEl.innerHTML = "Font: <b>fallback (couldn’t confirm)</b>";
  }
}

function drawBackground(){
  const g = ctx.createLinearGradient(0,0,0,630);
  g.addColorStop(0, bg.top);
  g.addColorStop(0.55, bg.mid);
  g.addColorStop(1, bg.bot);
  ctx.fillStyle = g;
  ctx.fillRect(0,0,1200,630);
}

function drawVignette(){
  const v = ctx.createRadialGradient(600,315,140,600,315,860);
  v.addColorStop(0,"rgba(0,0,0,0)");
  v.addColorStop(1,"rgba(0,0,0,0.55)");
  ctx.fillStyle = v;
  ctx.fillRect(0,0,1200,630);
}

// pixel corners
function drawPixelRoundedPanel(x,y,w,h,opts){
  const scale = 4;                      // pixelation factor
  const ow = Math.round(w/scale);
  const oh = Math.round(h/scale);

  const oc = document.createElement("canvas");
  oc.width = ow;
  oc.height = oh;
  const o = oc.getContext("2d");
  o.imageSmoothingEnabled = false;

  const fill = opts.fill ?? bg.panel;
  const stroke = opts.stroke ?? bg.ink;
  const sw = opts.strokeWidth ?? 3;     
  const rad = opts.radius ?? 6;         
  const innerStroke = opts.innerStroke ?? "rgba(242,239,220,0.25)";
  const innerSw = opts.innerStrokeWidth ?? 2;

  function roundRectPath(cx, cy, cw, ch, r){
    o.beginPath();
    o.moveTo(cx+r, cy);
    o.arcTo(cx+cw, cy, cx+cw, cy+ch, r);
    o.arcTo(cx+cw, cy+ch, cx, cy+ch, r);
    o.arcTo(cx, cy+ch, cx, cy, r);
    o.arcTo(cx, cy, cx+cw, cy, r);
    o.closePath();
  }

  // fillerrrrr
  roundRectPath(0,0,ow,oh,rad);
  o.fillStyle = fill;
  o.fill();

  // outer stroke
  o.lineJoin = "round";
  o.lineWidth = sw;
  o.strokeStyle = stroke;
  o.stroke();

  // inner frame 
  const inset = 3;
  roundRectPath(inset, inset, ow-2*inset, oh-2*inset, Math.max(2, rad-2));
  o.lineWidth = innerSw;
  o.strokeStyle = innerStroke;
  o.stroke();

  // draw upscaled
  ctx.imageSmoothingEnabled = false;
  ctx.drawImage(oc, x, y, ow*scale, oh*scale);
}

function drawText(title, subtitle){
  ctx.textAlign = "center";
  ctx.textBaseline = "top";

  //  title and smaller subtitle KILL ME
  ctx.fillStyle = bg.paper;
  ctx.font = "54px 'Press Start 2P', system-ui, sans-serif";
  ctx.fillText((title || "VALENTINE QUIZ").toUpperCase(), 600, panel.y + 54);

  ctx.fillStyle = bg.stone;
  ctx.font = "20px 'Press Start 2P', system-ui, sans-serif";
  ctx.fillText((subtitle || "a tiny valentine quiz for my pookie"), 600, panel.y + 134);
}

function drawHearts(){
  function pxHeart(x,y,scale,color){
    ctx.fillStyle = color;
    const p = 5 * scale; 
    const blocks = [
      [1,0],[3,0],
      [0,1],[1,1],[2,1],[3,1],[4,1],
      [0,2],[1,2],[2,2],[3,2],[4,2],
      [1,3],[2,3],[3,3],
      [2,4]
    ];
    for(const [bx,by] of blocks){
      ctx.fillRect(x + bx*p, y + by*p, p, p);
    }
  }

  
  function inVignetteEdgeZone(x,y){
    return (x < 120 || x > 1080 || y < 80 || y > 580);
  }

  
  function inPanelZone(x,y){
    return x > panel.x - 40 && x < panel.x + panel.w + 40 &&
           y > panel.y - 40 && y < panel.y + panel.h + 40;
  }

  let placed = 0;
  let safety = 0;

  while(placed < 25 && safety < 3000){
    safety++;

    const x = 120 + Math.random()*960;
    const y = 80  + Math.random()*500;

    if(inVignetteEdgeZone(x,y)) continue;
    if(inPanelZone(x,y)) continue;

    const s = (Math.random() < 0.88) ? 1 : 2;
    const col = heartColors[(Math.random()*heartColors.length) | 0];

    pxHeart(x, y, s, col);
    placed++;
  }
}

function render(){
  const title = document.getElementById("title").value || "VALENTINE QUIZ";
  const subtitle = document.getElementById("subtitle").value || "a tiny valentine quiz for my pookie";

  ctx.clearRect(0,0,1200,630);

  drawBackground();
  drawHearts();

  drawPixelRoundedPanel(panel.x, panel.y, panel.w, panel.h, {
    fill: bg.panel,
    stroke: bg.ink,
    strokeWidth: 3,            
    radius: 7,                 
    innerStroke: "rgba(242,239,220,0.25)",
    innerStrokeWidth: 2
  });

  drawText(title, subtitle);
  drawVignette();
}

document.getElementById("render").addEventListener("click", render);

document.getElementById("download").addEventListener("click", async () => {
  if(!fontReady) await ensureFont();
  render();
  const a = document.createElement("a");
  a.download = "og.png";
  a.href = C.toDataURL("image/png");
  a.click();
});

(async () => {
  render();
  await ensureFont();
  render();
})();
</script>
</body>
</html>
